{% extends 'base.html' %}
{% block title %}For Sale{% endblock %}

{% block content %}
<div class="forsale-container">
    <h2 class="text-center">Search License Plates</h2>
    
    <div class="search-container">
        <form method="get" class="search-form">
            <div class="search-group">
                <label>Plate Number:</label>
                <div class="number-dropdowns">
                    <select name="digit1" class="digit-select">
                        <option value="">Any</option>
                        {% for i in range(10) %}
                        <option value="{{ i }}" {% if digit1 == i|string %}selected{% endif %}>{{ i }}</option>
                        {% endfor %}
                    </select>
                    <select name="digit2" class="digit-select">
                        <option value="">Any</option>
                        {% for i in range(10) %}
                        <option value="{{ i }}" {% if digit2 == i|string %}selected{% endif %}>{{ i }}</option>
                        {% endfor %}
                    </select>
                    <select name="digit3" class="digit-select">
                        <option value="">Any</option>
                        {% for i in range(10) %}
                        <option value="{{ i }}" {% if digit3 == i|string %}selected{% endif %}>{{ i }}</option>
                        {% endfor %}
                    </select>
                    <select name="digit4" class="digit-select">
                        <option value="">Any</option>
                        {% for i in range(10) %}
                        <option value="{{ i }}" {% if digit4 == i|string %}selected{% endif %}>{{ i }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <div class="search-group">
                <label>Plate Letters:</label>
                <div class="letter-dropdowns">
                    <select name="letter1" class="letter-select">
                        <option value="">Any</option>
                        {% for letter in valid_letters %}
                        <option value="{{ letter }}" {% if letter1 == letter %}selected{% endif %}>
                            {{ letter }} ({{ letter_english[letter] }})
                        </option>
                        {% endfor %}
                    </select>
                    <select name="letter2" class="letter-select">
                        <option value="">Any</option>
                        {% for letter in valid_letters %}
                        <option value="{{ letter }}" {% if letter2 == letter %}selected{% endif %}>
                            {{ letter }} ({{ letter_english[letter] }})
                        </option>
                        {% endfor %}
                    </select>
                    <select name="letter3" class="letter-select">
                        <option value="">Any</option>
                        {% for letter in valid_letters %}
                        <option value="{{ letter }}" {% if letter3 == letter %}selected{% endif %}>
                            {{ letter }} ({{ letter_english[letter] }})
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <div class="sort-container">
                <label for="sort_by">Sort By:</label>
                <select name="sort_by" id="sort_by">
                    <option value="newest" {% if sort_by == 'newest' %}selected{% endif %}>Newest First</option>
                    <option value="oldest" {% if sort_by == 'oldest' %}selected{% endif %}>Oldest First</option>
                    <option value="price_high" {% if sort_by == 'price_high' %}selected{% endif %}>Most Expensive</option>
                    <option value="price_low" {% if sort_by == 'price_low' %}selected{% endif %}>Cheapest</option>
                </select>
            </div>

            <button type="submit" class="search-button">Search</button>
        </form>
    </div>

    <div class="plates-section">
        <div class="plates-grid">
            {% for plate in plates %}
            <div class="plate-card">
                <div class="mini-plate-preview">
                    <div class="mini-plate-numbers">
                        <div class="arabic-row">{{ plate.plateNumber }}</div>
                        <div class="english-row">{{ plate.plateNumber }}</div>
                    </div>
                    <div class="mini-plate-letters">
                        <div class="arabic-row">{{ plate.plateLetter }}</div>
                        <div class="english-row">{{ plate.plateLetter }}</div>
                    </div>
                    <div class="mini-ksa">
                        <span>K</span>
                        <span>S</span>
                        <span>A</span>
                    </div>
                </div>
                <p class="price">SAR {{ "%.2f"|format(plate.price) }}</p>
                <p class="description">{{ plate.description }}</p>
                <p class="date">Listed: {{ plate.created_at.strftime('%Y-%m-%d') }}</p>
                <a href="/plate/{{ plate.plateID }}" class="view-button">View Details</a>
            </div>
            {% else %}
            <p class="no-results">No plates found matching your criteria.</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %} 